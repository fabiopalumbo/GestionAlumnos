$(document).ready(function(){limpiaErroresLogin();iniciarToolTips();inicializarCalendarios();$("#botonFiltrar").click(function(c){var d=$("#fDesdeFiltrar").val();
var a=$("#fHastaFiltrar").val();if(compareDates(d,a)){$("#myModal").modal("show");$("#myModal .modal-body").text("La fecha desde es superior a la fecha hasta. Vuelve a introducir los datos");
return false;}else{var b=$("#comboTipoBalance").val();$("#idTipoBalanceFiltrar").val(b);$("#form-filtrar").submit();}});$("#botonNuevoBal").click(function(b){if($("#descripcion").val().length>0){var a=$("#fDesdeNuevo").val();
var c=$("#fHastaNuevo").val();if(compareDates(a,c)){$("#myModal").modal("show");$("#myModal .modal-body").text("La fecha desde es superior a la fecha hasta. Vuelve a introducir los datos");
return false;}}else{$("#myModal").modal("show");$("#myModal .modal-body").text("Debe indicarse un nombre de balance");return false;}});$("#botonExpCNMC").click(function(a){a.preventDefault();
a.stopPropagation();$.ajax({url:"checkPlantillaActiva.htm",type:"POST",contentType:false,success:function(b){if(b<0){$("#myModal").modal("show");$("#myModal .modal-body").text("No es posible generar el informe de la CNMC porque no hay una plantilla activa");
}else{$("#form-CNMC").submit();}},error:function(){}});});$("#botonExportar").click(function(g){g.preventDefault();var f=$("input:checked").length;if(f==1){var e=$("input:checked").val();
$("#idBalanceExportar").val(e);var b=$("input:checked").parent().siblings("td[name=fecha_inicio]").text();var c=$("input:checked").parent().siblings("td[name=fecha_fin]").text();
var a=$("#fDesdeExportar").val();var h=$("#fHastaExportar").val();if(periodoValido(b,c,a,h)){var d=$("#comboTipoBalance").val();$("#idTipoBalanceExportar").val(d);
$("*").css("cursor","wait");$("#form-exportar").submit();$(".sub-exportar").slideToggle();$("*").css("cursor","default");}else{$("#myModal").modal("show");
$("#myModal .modal-body").text("Revise el periodo seleccionado para realizar la exportacion");}}else{if(f==0){$("#myModal").modal("show");$("#myModal .modal-body").text("Seleccione un registro de la tabla");
return false;}else{$("#myModal").modal("show");$("#myModal .modal-body").text("No es posible seleccionar mas de un balance");return false;}}});$("#botonEliminar").click(function(d){d.preventDefault();
var c=$("input:checked").length;if(c>0){var a="";$("input:checked").each(function(){var e=$(this).val()+";";a+=e;});$("#idBalance").val(a);var b=$("#comboTipoBalance").val();
$("#idTipoBalanceEliminar").val(b);$("*").css("cursor","wait");$("#form-eliminar").submit();}else{if(c==0){$("#myModal").modal("show");$("#myModal .modal-body").text("Seleccione un registro de la tabla");
return false;}}});$("#botonInformes").click(function(){var a=document.getElementById("botonInformes").pathname;$("#botonInformes").attr(url,a);});$(".visor").click(function(){var a=$(this).siblings("label").attr("for");
var b=$("#comboTipoBalance").val();var c=$(this).siblings("input#estado").attr("value");if(c=="PUBLICABLE"){$("#id_balance_visor").val(a);$("#id_tipo_balance_visor").val(b);
$("*").css("cursor","wait");$("#form-visor").submit();}else{$("#myModal").modal("show");$("#myModal .modal-body").text("El balance debe estar en estado publicable.");
return false;}});$("#verAgruparDatos").click(function(){$("#modal-agrupar").modal("show");});$("#botonAgruparInformes").click(function(){var a=$("#form-agrupar #comboNivel1").val();
var f=$("#form-agrupar #comboNivel2").val();var e=$("#form-agrupar #comboNivel3").val();var d=$("#form-agrupar #comboNivel4").val();var b=$("#form-agrupar #comboNivel5").val();
var c;$.ajax({type:"POST",url:"agruparVisor.htm",data:{comboNivel1:a,comboNivel2:f,comboNivel3:e,comboNivel4:d,comboNivel5:b},dataType:"json",success:function(g){c=g;
if(c.error!==null&&c.error.length>2){$("#form-agrupar #mensajeError").text(""+c.error);}else{$("#form-agrupar #mensajeError").text("");$("#modal-agrupar").modal("hide");
}},error:function(i,g,h){alert("Error");alert(i.status);alert(h);}});});});function getDiffDias(c,b){var f=c.split("/");var a=new Date(f[2],parseFloat(f[1])-1,parseFloat(f[0]));
var d=b.split("/");var h=new Date(d[2],parseFloat(d[1])-1,parseFloat(d[0]));var g=h.getTime()-a.getTime();var e=Math.floor(g/(1000*60*60*24));return e;
}function inicializarCalendarios(){$(".calendario").datepicker({dateFormat:"dd/mm/yy",showOn:"button",buttonImage:"../img/ico-calendar.png",buttonImageOnly:true,closeText:"Cerrar",prevText:"<Ant",nextText:"Sig>",currentText:"Hoy",monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],dayNamesShort:["Dom","Lun","Mar","Mié","Juv","Vie","Sáb"],dayNamesMin:["Do","Lu","Ma","Mi","Ju","Vi","Sá"],weekHeader:"Sm",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:""});
}function iniciarToolTips(){$("td a img").tooltip();$("th a img").tooltip();}function limpiaErroresLogin(){$("#j_username").focus(function(){$("#messageError").empty();
});$("#j_password").focus(function(){$("#messageError").empty();});}function filtroBalances(){var c=$("#comboTipoBalance option").size();var b=$("#filtro").val();
var a=$("#tablaBalances >tbody >tr").size();if(c>1){$(".sub-filtrar").slideToggle();}else{if(c==1){$("#comboTipoBalance option").attr("selected",true);
if(a==0&&b==1){$("#botonFiltrar").click();}}}}function mostrarVentanaModal(a){alert(a);}function mostrarErrores(b,a){var c=true;if(c){if(b.status===0){alert("Not connect.\n Verify Network.");
}else{if(b.statusCode==404){alert("Requested page not found. [404]");}else{if(b.statusCode==500){alert("Internal Server Error [500].");}else{if(a==="parsererror"){alert("Requested JSON parse failed.");
}else{if(a==="timeout"){alert("Time out error.");}else{if(a==="abort"){alert("Ajax request aborted.");}else{alert("Uncaught Error.\n"+b.responseText);}}}}}}}}function cerrarAgruparDatos(){$("#modal-agrupar").modal("hide");
}